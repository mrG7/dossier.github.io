<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4. dossier.models — Active learning &mdash; dossier 0.3.4 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="dossier 0.3.4 documentation" href="index.html" />
    <link rel="next" title="5. dossier.web — DossierStack web services" href="dossier.web.html" />
    <link rel="prev" title="3. dossier.label — store ground truth data as labels" href="dossier.label.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dossier.web.html" title="5. dossier.web — DossierStack web services"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="dossier.label.html" title="3. dossier.label — store ground truth data as labels"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">dossier 0.3.4 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-dossier.models">
<span id="dossier-models-active-learning"></span><h1>4. <a class="reference internal" href="#module-dossier.models" title="dossier.models"><code class="xref py py-mod docutils literal"><span class="pre">dossier.models</span></code></a> &#8212; Active learning<a class="headerlink" href="#module-dossier.models" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">dossier.models</span></code> provides search engines and a <a class="reference internal" href="dossier.web.html#module-dossier.web" title="dossier.web"><code class="xref py py-mod docutils literal"><span class="pre">dossier.web</span></code></a>
application for working with active learning.</p>
<span class="target" id="module-dossier.models.web.run"></span><div class="section" id="web-services-for-active-learning-search-engines">
<h2>4.1. Web services for active learning search engines<a class="headerlink" href="#web-services-for-active-learning-search-engines" title="Permalink to this headline">¶</a></h2>
<p>This library ships with a command line application, <code class="docutils literal"><span class="pre">dossier.models</span></code>,
that runs a web service. It is easy to run:</p>
<div class="highlight-python"><div class="highlight"><pre>dossier.models -c config.yaml
</pre></div>
</div>
<p>This runs it on <code class="docutils literal"><span class="pre">localhost:8080</span></code>. A sample config file looks like:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">dossier.store</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">feature_indexes</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="s">&#39;bowNP_sip&#39;</span><span class="p-Indicator">,</span> <span class="s">&#39;phone&#39;</span><span class="p-Indicator">,</span> <span class="s">&#39;region&#39;</span><span class="p-Indicator">]</span>

<span class="l-Scalar-Plain">dossier.models</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">tfidf_path</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/path/to/tfidf/model.tfidf</span>

<span class="l-Scalar-Plain">kvlayer</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">app_name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">dossierstack</span>
  <span class="l-Scalar-Plain">namespace</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">myapp</span>
  <span class="l-Scalar-Plain">storage_type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">redis</span>
  <span class="l-Scalar-Plain">storage_addresses</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="s">&#39;localhost:6379&#39;</span><span class="p-Indicator">]</span>
</pre></div>
</div>
<p>Where the <code class="docutils literal"><span class="pre">tfidf_path</span></code> corresponds to a TF-IDF model generated by
<code class="docutils literal"><span class="pre">gensim</span></code>. You can create one with the <code class="docutils literal"><span class="pre">dossier.etl</span> <span class="pre">tfidf</span></code> command.
(Note that this is optional!)</p>
<p>Once <code class="docutils literal"><span class="pre">dossier.models</span></code> is running, you can try the
Sorting Desk browser extension for Google Chrome:
<a class="reference external" href="https://chrome.google.com/webstore/detail/sorting-desk/ikcaehokdafneaiojndpmfbimilmlnid">https://chrome.google.com/webstore/detail/sorting-desk/ikcaehokdafneaiojndpmfbimilmlnid</a>.
Once the extension is installed, you&#8217;ll need to go to
its options and configure it to point to <code class="docutils literal"><span class="pre">http://localhost:8080</span></code>.</p>
<p>Alternatively, you can follow the steps here to get a simple example
working on a sample data set:
<a class="reference external" href="https://github.com/dossier/dossier.models#running-a-simple-example">https://github.com/dossier/dossier.models#running-a-simple-example</a>.</p>
<div class="section" id="web-service-endpoints">
<h3>4.1.1. Web service endpoints<a class="headerlink" href="#web-service-endpoints" title="Permalink to this headline">¶</a></h3>
<p>The web service has all of the same endpoints as <a class="reference internal" href="dossier.web.html#module-dossier.web" title="dossier.web"><code class="xref py py-mod docutils literal"><span class="pre">dossier.web</span></code></a>.
A couple of the endpoints are slightly enhanced to take advantage of
<code class="docutils literal"><span class="pre">dossier.models</span></code> pairwise learning algorithm and feature extraction.
These enhanced endpoints are <a class="reference internal" href="dossier.web.html#dossier.web.routes.v1_search" title="dossier.web.routes.v1_search"><code class="xref py py-func docutils literal"><span class="pre">dossier.web.routes.v1_search()</span></code></a> and
<a class="reference internal" href="dossier.web.html#dossier.web.routes.v1_fc_put" title="dossier.web.routes.v1_fc_put"><code class="xref py py-func docutils literal"><span class="pre">dossier.web.routes.v1_fc_put()</span></code></a>. The <code class="docutils literal"><span class="pre">v1_search</span></code> endpoint is
enhanced with the addition of the <code class="xref py py-func docutils literal"><span class="pre">dossier.models.similar()</span></code> and
<code class="xref py py-func docutils literal"><span class="pre">dossier.models.dissimilar()</span></code> search engines. Additionally, the
<code class="docutils literal"><span class="pre">v1_fc_put</span></code> accepts <code class="docutils literal"><span class="pre">text/html</span></code> content and will generate a feature
collection for you.</p>
</div>
<div class="section" id="how-the-sorting-desk-browser-extension-works">
<h3>4.1.2. How the Sorting Desk browser extension works<a class="headerlink" href="#how-the-sorting-desk-browser-extension-works" title="Permalink to this headline">¶</a></h3>
<p>SortingDesk needs a <code class="docutils literal"><span class="pre">dossier.models</span></code> web server in order to function
properly. Namely, it uses <code class="docutils literal"><span class="pre">dossier.models</span></code> (and the underlying
DossierStack) to add/update feature collections, store ground truth
data as &#8220;labels,&#8221; and run pairwise learning algorithms to rank relevant
search results. All of this information is saved to the underlying
database, so it is persistent across all user sessions.</p>
<p><code class="docutils literal"><span class="pre">dossier.models</span></code> also provides a folder/sub-folder organization
UI. Currently, this is built on top of Google Chrome&#8217;s local storage.
Namely, it doesn&#8217;t yet use the folder/subfolder web services described
in <a class="reference internal" href="dossier.web.html#module-dossier.web" title="dossier.web"><code class="xref py py-mod docutils literal"><span class="pre">dossier.web</span></code></a>. Therefore, folders/sub-folders don&#8217;t yet persist
across multiple user sessions, but they will once we migrate off of
Chrome&#8217;s local storage.</p>
</div>
</div>
<span class="target" id="module-dossier.models.pairwise"></span><div class="section" id="active-learning-pairwise-search-engines">
<h2>4.2. Active learning pairwise search engines<a class="headerlink" href="#active-learning-pairwise-search-engines" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="dossier.models.pairwise.similar">
<code class="descclassname">dossier.models.pairwise.</code><code class="descname">similar</code><span class="sig-paren">(</span><em>store</em>, <em>label_store</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/pairwise.html#similar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.pairwise.similar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="dossier.models.pairwise.dissimilar">
<code class="descclassname">dossier.models.pairwise.</code><code class="descname">dissimilar</code><span class="sig-paren">(</span><em>store</em>, <em>label_store</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/pairwise.html#dissimilar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.pairwise.dissimilar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="dossier.models.pairwise.PairwiseFeatureLearner">
<em class="property">class </em><code class="descclassname">dossier.models.pairwise.</code><code class="descname">PairwiseFeatureLearner</code><span class="sig-paren">(</span><em>store</em>, <em>label_store</em>, <em>content_id</em>, <em>subtopic_id=None</em>, <em>canopy_limit=None</em>, <em>label_limit=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/pairwise.html#PairwiseFeatureLearner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.pairwise.PairwiseFeatureLearner" title="Permalink to this definition">¶</a></dt>
<dd><p>A pairwise active learning model.</p>
<p>This active learning model applies
<code class="xref py py-class docutils literal"><span class="pre">LogisticRegression</span></code> on-the-fly
as a user (or simulated user) interacts with content
via the web services provided by <a class="reference internal" href="dossier.web.html#module-dossier.web" title="dossier.web"><code class="xref py py-mod docutils literal"><span class="pre">dossier.web</span></code></a>.</p>
<p>This reads <a class="reference internal" href="dossier.label.html#dossier.label.Label" title="dossier.label.Label"><code class="xref py py-class docutils literal"><span class="pre">Label</span></code></a> objects from
<a class="reference internal" href="dossier.label.html#dossier.label.LabelStore" title="dossier.label.LabelStore"><code class="xref py py-class docutils literal"><span class="pre">LabelStore</span></code></a> and provides predictions of
pairwise equivalence, which can be used for coreference resolution,
clustering, and ranking.</p>
<dl class="method">
<dt id="dossier.models.PairwiseFeatureLearner.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>store</em>, <em>label_store</em>, <em>content_id</em>, <em>subtopic_id=None</em>, <em>canopy_limit=None</em>, <em>label_limit=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/pairwise.html#PairwiseFeatureLearner.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.PairwiseFeatureLearner.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a new model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>store</strong> (<a class="reference internal" href="dossier.store.html#dossier.store.Store" title="dossier.store.Store"><code class="xref py py-class docutils literal"><span class="pre">dossier.store.Store</span></code></a>) &#8211; A store of feature collections.</li>
<li><strong>label_store</strong> (<a class="reference internal" href="dossier.label.html#dossier.label.LabelStore" title="dossier.label.LabelStore"><code class="xref py py-class docutils literal"><span class="pre">dossier.label.LabelStore</span></code></a>) &#8211; A store of labels (ground truth data).</li>
<li><strong>content_id</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The query content id (which should correspond
to a feature collection in the <code class="docutils literal"><span class="pre">store</span></code>).
If it doesn&#8217;t, no results are returned.</li>
<li><strong>canopy_limit</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; A limit on the number of results to return
in the canopy (the initial index scan).
This is meant to be a mechanism for resource
control.</li>
<li><strong>label_limit</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; A limit on the number of labels to use in
training. This is meant to be a mechanism for
resource control.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dossier.models.PairwiseFeatureLearner.probabilities">
<code class="descname">probabilities</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/pairwise.html#PairwiseFeatureLearner.probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.PairwiseFeatureLearner.probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains a model and predicts recommendations.</p>
<p>If the query feature collection could not be found or if there
is insufficient training data, an empty list is returned.</p>
<p>Otherwise, a list of content objects (tuples of content
id and feature collection) and probabilities is returned.
The probability is generated from the model, and reflects
confidence of the model that the corresponding content object
is related to the query based on the ground truth data.</p>
<p>On a large database, random samples are used for training, so
this function is not deterministic.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">list</span></code> of
((<code class="docutils literal"><span class="pre">content_id</span></code>, <a class="reference internal" href="dossier.fc.html#dossier.fc.FeatureCollection" title="dossier.fc.FeatureCollection"><code class="xref py py-class docutils literal"><span class="pre">dossier.fc.FeatureCollection</span></code></a>),
probability)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-dossier.models.features"></span><div class="section" id="feature-extraction">
<h2>4.3. Feature extraction<a class="headerlink" href="#feature-extraction" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">dossier.models.features</span></code> provides some convenience functions for
feature extraction.</p>
<dl class="function">
<dt id="dossier.models.features.noun_phrases">
<code class="descclassname">dossier.models.features.</code><code class="descname">noun_phrases</code><span class="sig-paren">(</span><em>text</em>, <em>included_unnormalized=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/features/sip.html#noun_phrases"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.features.noun_phrases" title="Permalink to this definition">¶</a></dt>
<dd><p>applies normalization to the terms found by noun_phrases_as_tokens
and joins on &#8216;_&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list of phrase strings with spaces replaced by <code class="docutils literal"><span class="pre">_</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="dossier.models.features.entity_names">
<code class="descclassname">dossier.models.features.</code><code class="descname">entity_names</code><span class="sig-paren">(</span><em>config=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/features/_names.html#entity_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.features.entity_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform on <code class="xref py py-class docutils literal"><span class="pre">FeatureCollection</span></code> that constructs
<cite>StringCounter</cite> features using <cite>nltk</cite>-based NER.</p>
</dd></dl>

<dl class="function">
<dt id="dossier.models.features.ICQs">
<code class="descclassname">dossier.models.features.</code><code class="descname">ICQs</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/features/basic.html#ICQs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.features.ICQs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="dossier.models.features.skypes">
<code class="descclassname">dossier.models.features.</code><code class="descname">skypes</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/features/basic.html#skypes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.features.skypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of skype handles.</p>
</dd></dl>

<dl class="function">
<dt id="dossier.models.features.host_names">
<code class="descclassname">dossier.models.features.</code><code class="descname">host_names</code><span class="sig-paren">(</span><em>urls</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/features/basic.html#host_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.features.host_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a StringCounter of normalized URL and parses their hostnames</p>
<p>N.B. this assumes that absolute URLs will begin with</p>
<p><a class="reference external" href="http://">http://</a></p>
<p>in order to accurately resolve the host name.
Relative URLs will not have host names.</p>
</dd></dl>

<dl class="function">
<dt id="dossier.models.features.usernames">
<code class="descclassname">dossier.models.features.</code><code class="descname">usernames</code><span class="sig-paren">(</span><em>urls</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/extraction/usernames.html#usernames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.features.usernames" title="Permalink to this definition">¶</a></dt>
<dd><p>Take an iterable of <cite>urls</cite> of normalized URL or file paths and
attempt to extract usernames.  Returns a list.</p>
</dd></dl>

<dl class="function">
<dt id="dossier.models.features.emails">
<code class="descclassname">dossier.models.features.</code><code class="descname">emails</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/features/basic.html#emails"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.features.emails" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of phone numbers without punctuation.</p>
</dd></dl>

<dl class="function">
<dt id="dossier.models.features.phones">
<code class="descclassname">dossier.models.features.</code><code class="descname">phones</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/features/basic.html#phones"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.features.phones" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of phone numbers without punctuation.</p>
</dd></dl>

<dl class="function">
<dt id="dossier.models.features.image_urls">
<code class="descclassname">dossier.models.features.</code><code class="descname">image_urls</code><span class="sig-paren">(</span><em>html</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/features/basic.html#image_urls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.features.image_urls" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<span class="target" id="module-dossier.models.etl"></span><span class="target" id="module-dossier.models.dragnet"></span><p>Detects mention and selector correlations across documents in the
dossiers (folders), thus generating recommendations for querying and
highlighting.</p>
<div class="section" id="dragnet">
<h2>4.4. Dragnet<a class="headerlink" href="#dragnet" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="dossier.models.dragnet.make_feature">
<code class="descclassname">dossier.models.dragnet.</code><code class="descname">make_feature</code><span class="sig-paren">(</span><em>fc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/dragnet.html#make_feature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.dragnet.make_feature" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a new <cite>StringCounter</cite> from the many <cite>StringCounters</cite> in the
input <cite>fc</cite>.  This StringCounter will define one of the targets for
the <cite>MultinomialNB</cite> classifier.</p>
<p>This crucial function decides the relative importance of features
extracted by the ETL pipeline.  This is essentially a form of
domain fitting that allows us to tune the extraction to the fields
that are important to a domain.  However, if the NER for a domain
is inadequate, then the primary purpose of these relative
weightings is to remove bogus NER extractions.</p>
</dd></dl>

<dl class="function">
<dt id="dossier.models.dragnet.worker">
<code class="descclassname">dossier.models.dragnet.</code><code class="descname">worker</code><span class="sig-paren">(</span><em>work_unit</em>, <em>max_sample=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/dragnet.html#worker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.dragnet.worker" title="Permalink to this definition">¶</a></dt>
<dd><p>Expects a coordinate WorkUnit for DragNet and runs the following
steps:</p>
<p>1. scans all dossiers at the <em>folder</em> level and assembles feature
vectors for each folder &#8211; see <cite>make_feature</cite></p>
<p>2. trains a multinomial naive Bayes classifier that treats each
<em>folder</em> as a classifier target.</p>
<p>3. sample the corpus by scanning up to <cite>max_sample</cite> and applying
the classifier to each item to get an approx &#8220;size&#8221; of the Folder</p>
<p>4. Bootstrap by treating those classifier predictions as truth
data and extract the learned features that are predictive as new
query strings.</p>
<p>5. Put the data in kvlayer for webservice end point to return to
polling client &#8211; see dossier.models.routes</p>
</dd></dl>

</div>
<span class="target" id="module-dossier.models.soft_selectors"></span><p>Algorithmically determine soft selector strings.</p>
<div class="section" id="soft-selectors">
<h2>4.5. Soft selectors<a class="headerlink" href="#soft-selectors" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="dossier.models.soft_selectors.find_soft_selectors">
<code class="descclassname">dossier.models.soft_selectors.</code><code class="descname">find_soft_selectors</code><span class="sig-paren">(</span><em>ids_and_clean_visible</em>, <em>start_num_tokens='10'</em>, <em>max_num_tokens='20'</em>, <em>filter_punctuation='0'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/soft_selectors.html#find_soft_selectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.soft_selectors.find_soft_selectors" title="Permalink to this definition">¶</a></dt>
<dd><p>External interface for dossier.models.soft_selectors.</p>
<p>This at scans through <cite>num_tokens</cite> values between
<cite>start_num_tokens</cite> and <cite>max_num_tokens</cite> and calls
<cite>find_soft_selectors_at_n</cite> looking for results</p>
<p>All of the params can be passed from URL parameters, in which
case they can be strings and this function will type cast them
appropriately.</p>
</dd></dl>

<dl class="function">
<dt id="dossier.models.soft_selectors.make_ngram_corpus">
<code class="descclassname">dossier.models.soft_selectors.</code><code class="descname">make_ngram_corpus</code><span class="sig-paren">(</span><em>corpus_clean_visibles</em>, <em>num_tokens</em>, <em>filter_punctuation</em>, <em>zoning_rules=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/soft_selectors.html#make_ngram_corpus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.soft_selectors.make_ngram_corpus" title="Permalink to this definition">¶</a></dt>
<dd><p>takes a list of clean_visible texts, such as from StreamItems or
FCs, tokenizes all the texts, and constructs n-grams using
<cite>num_tokens</cite> sized windows.</p>
<p><code class="docutils literal"><span class="pre">corpus_clean_visibles</span></code> &#8211; list of unicode strings
<code class="docutils literal"><span class="pre">num_tokens</span></code> &#8212; the n of the n-grams
<code class="docutils literal"><span class="pre">filter_punctuation</span></code> &#8212; if True, punctuation is filtered</p>
</dd></dl>

</div>
<span class="target" id="module-dossier.models.linker"></span><div class="section" id="module-dossier.models.linker.model">
<span id="linking"></span><h2>4.6. Linking<a class="headerlink" href="#module-dossier.models.linker.model" title="Permalink to this headline">¶</a></h2>
<p>Create a keyword searches from an entity profile.  Given a labeled
collection of feature collections, train a classifier to identify the
entity using such as scikit-learn Bernoulli naive Bayes:</p>
<p><a class="reference external" href="http://scikit-learn.org/stable/modules/naive_bayes.html">http://scikit-learn.org/stable/modules/naive_bayes.html</a></p>
<p><a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes">http://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes</a>
.BernoulliNB.html#sklearn.naive_bayes.BernoulliNB</p>
<dl class="function">
<dt id="dossier.models.linker.model.extract">
<code class="descclassname">dossier.models.linker.model.</code><code class="descname">extract</code><span class="sig-paren">(</span><em>positive_fcs</em>, <em>negative_fcs</em>, <em>features=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/linker/model.html#extract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.linker.model.extract" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Takes a labeled set of feature collections (positive and negative)</dt>
<dd><p class="first">and the features wanted. And trains a Naive Bayes classifier on
the underlying keys of the set of selected features features.
If no features are selected, all are used.</p>
<p class="last">Returns two list of (keywords, strength) tuples ordered by strength. The
first are feature keys that were predictive of the positive
label and the second are the feature keys are were predictive
of the negative label.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">*_fcs</span></code> is the list of feature collections, positive label and</dt>
<dd>negative label respectively.</dd>
<dt><code class="docutils literal"><span class="pre">features</span></code> designates which specific feature gets vectorized the</dt>
<dd>other features are ignored.</dd>
</dl>
</dd></dl>

<span class="target" id="module-dossier.models.linker.worker"></span><p>coordinate/rejester worker function for executing query generation
from a set of dossiers for use with open query.</p>
<dl class="function">
<dt id="dossier.models.linker.worker.worker">
<code class="descclassname">dossier.models.linker.worker.</code><code class="descname">worker</code><span class="sig-paren">(</span><em>work_unit</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/linker/worker.html#worker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.linker.worker.worker" title="Permalink to this definition">¶</a></dt>
<dd><p>Expects a WorkUnit from coordinated, obtains a config, and runs
traverse_extract_fetch</p>
</dd></dl>

<dl class="function">
<dt id="dossier.models.linker.worker.traverse_extract_fetch">
<code class="descclassname">dossier.models.linker.worker.</code><code class="descname">traverse_extract_fetch</code><span class="sig-paren">(</span><em>config</em>, <em>wukey</em>, <em>stop_after_extraction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/linker/worker.html#traverse_extract_fetch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.linker.worker.traverse_extract_fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a config and a
<cite>wukey=cbor.dumps((folder_name,subfolder_name))</cite>, traverse the
folders to generate queries, issue them to Google, fetch the
results, and ingest them.</p>
</dd></dl>

<dl class="function">
<dt id="dossier.models.linker.worker.get_subfolder_queries">
<code class="descclassname">dossier.models.linker.worker.</code><code class="descname">get_subfolder_queries</code><span class="sig-paren">(</span><em>store</em>, <em>label_store</em>, <em>folders</em>, <em>fid</em>, <em>sid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/linker/worker.html#get_subfolder_queries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.linker.worker.get_subfolder_queries" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns [unicode].</p>
<p>This returns a list of queries that can be passed on to &#8220;other&#8221;
search engines. The list of queries is derived from the subfolder
identified by <code class="docutils literal"><span class="pre">fid/sid</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="dossier.models.linker.worker.extract_keyword_queries">
<code class="descclassname">dossier.models.linker.worker.</code><code class="descname">extract_keyword_queries</code><span class="sig-paren">(</span><em>store</em>, <em>label_store</em>, <em>folders</em>, <em>fid</em>, <em>sid</em>, <em>include_original=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/linker/worker.html#extract_keyword_queries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.linker.worker.extract_keyword_queries" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a folder structure into positive and negative examples
to feed to <code class="docutils literal"><span class="pre">linker.model.extract</span></code>.  This transforms SortingDesk&#8217;s
foldering structure into <em>supervision</em> data for the extractor.</p>
<p>This works best if folder name (<code class="docutils literal"><span class="pre">fid</span></code>) is the <code class="docutils literal"><span class="pre">name</span></code> of an entity
in question or, more generally, a query that a user might have
issued to a search engine.  In particular, this approach makes
sense for the annotated version of this task, which is what
SortingDesk enables.</p>
<p>This returns five queries with the original_query name:</p>
<blockquote>
<div><ol class="arabic simple" start="0">
<li>if <cite>include_original</cite>, then original name; the model will
eliminate if bad but it seems like it&#8217;s a mistake to omit</li>
<li>plus the most predictive keyword</li>
<li>minus the least predictive keyword</li>
<li>minus the most predictive keyword for the negative class</li>
<li>plus the least predictive keyword for the negative class</li>
</ol>
</div></blockquote>
<p>Additionally, if any of these words are the name, we skip to the
next keyword in the list.</p>
<p>Returns a three tuple of ([unicode], [unicode], bool) where the
first list is query strings to send to a search engine, and the
second list is feature strings to put in a StringCounter.</p>
</dd></dl>

<dl class="function">
<dt id="dossier.models.linker.worker.name_filter">
<code class="descclassname">dossier.models.linker.worker.</code><code class="descname">name_filter</code><span class="sig-paren">(</span><em>keywords</em>, <em>names</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dossier/models/linker/worker.html#name_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dossier.models.linker.worker.name_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the first keyword from the list, unless
that keyword is one of the names in names, in which case
it continues to the next keyword.</p>
<p>Since keywords consists of tuples, it just returns the first
element of the tuple, the keyword. It also adds double
quotes around the keywords, as is appropriate for google queries.</p>
<p>Input Arguments:
keywords &#8211; a list of (keyword, strength) tuples
names &#8211; a list of names to be skipped</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">4. <code class="docutils literal"><span class="pre">dossier.models</span></code> &#8212; Active learning</a><ul>
<li><a class="reference internal" href="#web-services-for-active-learning-search-engines">4.1. Web services for active learning search engines</a><ul>
<li><a class="reference internal" href="#web-service-endpoints">4.1.1. Web service endpoints</a></li>
<li><a class="reference internal" href="#how-the-sorting-desk-browser-extension-works">4.1.2. How the Sorting Desk browser extension works</a></li>
</ul>
</li>
<li><a class="reference internal" href="#active-learning-pairwise-search-engines">4.2. Active learning pairwise search engines</a></li>
<li><a class="reference internal" href="#feature-extraction">4.3. Feature extraction</a></li>
<li><a class="reference internal" href="#dragnet">4.4. Dragnet</a></li>
<li><a class="reference internal" href="#soft-selectors">4.5. Soft selectors</a></li>
<li><a class="reference internal" href="#module-dossier.models.linker.model">4.6. Linking</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="dossier.label.html"
                        title="previous chapter">3. <code class="docutils literal"><span class="pre">dossier.label</span></code> &#8212; store ground truth data as labels</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dossier.web.html"
                        title="next chapter">5. <code class="docutils literal"><span class="pre">dossier.web</span></code> &#8212; DossierStack web services</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/dossier.models.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dossier.web.html" title="5. dossier.web — DossierStack web services"
             >next</a> |</li>
        <li class="right" >
          <a href="dossier.label.html" title="3. dossier.label — store ground truth data as labels"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">dossier 0.3.4 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Diffeo, Inc..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>